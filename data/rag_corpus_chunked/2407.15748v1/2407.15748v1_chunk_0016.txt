procedure ENTITY EXTRACTOR (q′) 8: Utilize the Haystack framework with ”dslim/bert-base- NER” to detect entities E in q′. 9: Start with an empty Queries_List Q and include q′. 10: for each detected entity e ∈ E do 11: if e refers to a person (PER) then 12: Append a question about e to Q: "Who is e?" 13: else if e pertains to an object or concept (OBJ/CON) then 14: Append a question about e to Q: "What is e?" 15: end if 16: end for 17: return Q 18: end procedure 19: procedure QUERY HANDLING (q) 20: qvuln ← VULNERABILITY EXTRACTOR (q) 21: Q′ ← ENTITY EXTRACTOR (qvuln) 22: return Q′ 23: end procedure Fig. 4: Structured RAG Workflow. links from the MITRE website. This retriever utilizes embed- dings (α). To ensure accurate matches, the system exclusively evaluates malware with a similarity score exceeding 0.7, corresponding to the Test distribution’s median. b) Metasploit Retriever : We have developed the Metasploit Retriever so that it can be effectively integrated into the Metasploit Framework. Its knowledge base includes over 4900 cybersecurity elements, including exploits, encoders, payloads, and various modules. To increase the retrieval speed, we only index salient parts of codes such as code descriptions and exploit information. It performs a semantic search using a similarity value of 0.75 (Q3 of the test distribution) with ( α) embedding, along with a keyword search supported by the TF-IDF algorithm [52]. c) ExploitDB Retriever: The knowledge base of this retriever is made up of exploits from the ExploitDB framework. These codes often lack descriptions, so we use a keyword search with the TF-IDF algorithm [52] to focus only on important data such as CVE identifiers and author names, which are usually at the beginning of the scripts. To increase the retrieval speed, we