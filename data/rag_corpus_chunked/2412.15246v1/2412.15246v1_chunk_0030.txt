vectors in blocks of 68 vectors, laid out in the DRAM as shown in Figure 7. Because each embedding vector dimension is 2 bytes (16-bit floating point), each block is stored in136√óùëâ ùê∑ bytes within DRAM, whereVD is the vector dimension. Within a block, the embedding vectors are stored in column-major order. This layout allows for efficient batching of corpus vectors, as each Byte Offset134420Physica AddressEV[67][0]‚Ä¶EV[2][0]EV[1][0]EV[0][0]B EV[67][1]‚Ä¶EV[2][1]EV[1][1]EV[0][1]B + 0*136*VD + 136*1 EV[67][2]‚Ä¶EV[2][2]EV[1][2]EV[0][2]B + 0*136*VD + 136*2‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ EV[67][VD-1]‚Ä¶EV[2][VD-1]EV[1][VD-1]EV[0][VD-1]B + 0*136*VD + 136*(VD-1)EV[135][0]‚Ä¶EV[70][0]EV[69][0]EV[68][0]B + 1*136*VD ‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ EV[135][VD-1]‚Ä¶EV[70][VD-1]EV[69][VD-1]EV[68][VD-1]B + 1*136*VD + 136*(VD-1)‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ EV[N-1][0]‚Ä¶EV[N-66][0]EV[N-67][0]EV[N-68][0]B + (N-67)*136*VD EV[N-1][1]‚Ä¶EV[N-66][1]EV[N-67][1]EV[N-68][1]B + (N-67)*136*VD + 136*1‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶EV[N-1][VD-1]‚Ä¶EV[N-66][VD-1]EV[N-67][VD-1]EV[N-68][VD-1]B + (N-67)*136*VD + 136*(VD-1) EV[0]EV[2]EV[N-67]EV[N-1] Fig. 7. Data layout inside each LPDDR5X package. The host CPU communi- cates the base address "B", vector dimension "VD", and the number of vectors "N" to the NMAs for each offload. Four embedding vectors (EVs) are high- lighted in this layout. Byte Offset(Batch Size = 4)2*(VD-1)420Physica AddressQV[0][VD-1]‚Ä¶QV[0][2]QV[0][1]QV[0][0]QS_BQV[1][VD-1]‚Ä¶QV[1][2]QV[1][1]QV[1][0]QS_B + 2048QV[2][VD-1]‚Ä¶QV[2][2]QV[2][1]QV[2][0]QS_B + 2 * 2048 QV[3][VD-1]‚Ä¶QV[3][2]QV[3][1]QV[3][0]QS_B + 3 * 2048QV[0]QV[3]Byte Offset(Batch Size = 1)2*(VD-1)420Physica AddressQV[0][VD-1]‚Ä¶QV[0][2]QV[0][1]QV[0][0]QS_BQV[0]Byte Offset(Batch Size = 64)2*(VD-1)420Physica AddressQV[0][VD-1]‚Ä¶QV[0][2]QV[0][1]QV[0][0]QS_BQV[1][VD-1]‚Ä¶QV[1][2]QV[1][1]QV[1][0]QS_B + 2048‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶‚Ä¶ QV[63][VD-1]‚Ä¶QV[63][2]QV[63][1]QV[63][0]QS_B + 63 * 2048QV[0]QV[63] Fig. 8. Data layout inside the query scratchpads mapped to host memory address at query scratchpad base address "QS_B". As we increase the batch size, more query scratchpads are populated with distinct query vectors. Platform Parameter Description CPU CPU model Intel Xeon 4416+ 16 cores @ 2.00 GHz L1 Cache 48 kB dcache, 32kB icache L2 Cache 2MB L3 Cache 37.5 MB shared AVX 2x AVX-512 FMA units (164 GFlop/s/core) OS Ubuntu 22.04.3 Kernel Linux 5.15.0-88-generic Memory 512 GB DDR5-4000 across 8 channels (256 GB/s) AMX ‚Äì Intel AMX (BFloat16, 500 GFlop/s/core) IKS (emulated) ‚Äì 1.1 TB/s, 69.9 TFlop/s GPU GPU Model NVIDIA H100 SXM: 3.35 TB/s, 1979 TFlop/s Table 2. Processing Element Options. Memory configuration for Intel AMX is the same