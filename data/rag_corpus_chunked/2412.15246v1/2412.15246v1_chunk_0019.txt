CXL-PNM [57] and MTIA [16]. One of the key differences between IKS and these architectures is the scale-out near-memory accelera- tion architecture. IKS distributes the NMA logic over multiple chips, each providing high-bandwidth and low-energy access to its local LPDDR5X package. Why Scale-Out NMA Architecture?The rationale for such a scale-out NMA architecture is to keep the area of the NMA chip in check. Because memory PHYs are only implemented at the shoreline of a chip [16; 51; 60], to implement 64 LPDDR5X Accelerating Retrieval-Augmented Generation SSD CPUHost Mem GPU CXL CtrlNMANMANMA LPDDR5X Package 0LPDDR5X Package 1 LPDDR5X Package 7IKSLLMDocs CXL.mem/cache… PCIe x16 (64GBps) Eight x2 PCIe Uplinks (64GBps)Eight octa channel packages (1TBps) Embeddings CPUHost Mem GPU NMANMA LPDDR5X Package 0 LPDDR5X Package 7IKSLLM CXL.mem/cache… x16 PCIex2 PCIe8x Channel Embeddings Docs QV[PE][j]EV[i][j] EV[i+67][j] 2B Shift and Compare Unit Host MemoryIKS (CXL)Memory CB 0 CB 511 512 Context Buffers (64 per NMA) … NMACXL CtrlLPDDR5X Package 1 PCIe Controller Control Signals8⨉ LPDDR5X Channels ⨉2 PCIe Uplinks Data Signals …QueryScratchpad MAC 0 MAC 67 Dot-Product Unit Top-K UnitOutput Scratchpad Processing Engine 0… QueryScratchpad MAC 0 MAC 67 Dot-Product Unit Top-K UnitOutput Scratchpad Processing Engine 63… Control Unit From Memory Controllers From Memory Controllers Memory ControllersQV[PE][j] WEScore REGSEL MAC Unit 0 MACMAC REG WEScore REGSEL MAC Unit 67 MACMAC REG… 2B Ordered Score List Top-K Unit CTRL To Output Scratchpad From Memory Controllers and Query Scratchpad (a) System Address Space with IKS SSD CPUHost Mem GPU CXL CtrlNMANMANMA LPDDR5X Package 0LPDDR5X Package 1 LPDDR5X Package 7IKSLLMDocs CXL.mem/cache… PCIe x16 (64GBps) Eight x2 PCIe Uplinks (64GBps)Eight octa channel packages (1TBps) Embeddings CPUHost Mem GPU NMANMA LPDDR5X Package 0 LPDDR5X Package 7IKSLLM CXL.mem/cache… x16 PCIex2 PCIe8x Channel Embeddings Docs QV[PE][j]EV[i][j] EV[i+67][j] 2B Shift and Compare Unit Host MemoryIKS (CXL)Memory CB 0 CB 511 512 Context Buffers