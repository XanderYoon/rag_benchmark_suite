arXiv:2506.06962v3 [cs.CV] 14 Jun 2025 AR-RAG : Autoregressive Retrieval Augmentation for Image Generation Jingyuan Qi* 1 Zhiyang Xu* 1 Qifan Wang2 Lifu Huang3 1Virginia Tech 2Meta 3 UC Davis jingyq1@vt.edu (a) Vanilla Image Generation Prompt (c) Patch-based Autoregressive Retrieval Augmentation (Ours) ... Augmentation Generation Prompt Generated Image Generated Image (b) Image-Based Retrieval Augmentation Prompt Generated Image Retrieved Images ... Query Key Query Key Query Value Key Retrieval Value Value ? ? Next Image Patch ? Figure 1: Comparison between Autoregressive Retrieval Augmentation ( AR-RAG ) for image generation in (c) and existing image generation paradigms in (a) (b). In AR-RAG , image patches in red boxes denote retrieval queries and keys, image patches in blue boxes are retrieved values, and gray boxes with the question mark are next image patches to be predicted. (Caption: A white cat is playing basketball on the court.) Abstract We introduce Autoregressive Retrieval Augmentation ( AR-RAG ), a novel paradigm that enhances image generation by autoregressively incorporating k- nearest neighbor retrievals at the patch level. Unlike prior methods that perform a single, static retrieval before generation and condition the entire generation on fixed reference images, AR-RAG performs context-aware retrievals at each gen- eration step, using prior-generated patches as queries to retrieve and incorporate the most relevant patch-level visual references, enabling the model to respond to evolving generation needs while avoiding limitations (e.g., over-copying, stylis- tic bias, etc.) prevalent in existing methods. To realize AR-RAG , we propose two parallel frameworks: (1) Distribution-Augmentation in Decoding (DAiD), a training-free plug-and-use decoding strategy that directly merges the distribu- tion of model-predicted patches with the distribution of retrieved patches, and (2) Feature-Augmentation in Decoding (FAiD), a parameter-efficient fine-tuning method that progressively smooths the features of retrieved patches via multi-scale convolution operations and leverages them to augment the image generation