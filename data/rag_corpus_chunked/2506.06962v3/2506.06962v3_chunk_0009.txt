augment the probability distribution of predicted patches using retrieved ones, it suffers from noise propagation and limited flexibility in 4 ？ Retrieval Database ... Patch-based Image Retriever Generated Patches Convolutional Layer MLP Layer Feature-Augmentation in Decoding (FAiD) Decoder Layer RMS Norm Self-Attn RMS Norm FFD RMS Norm Previous Patch Embeddings Retrieval Embeddings Janus-Pro SPB ... 1 2 3 4 5 6 7 8 9 10 1 2 10 1 2 9 10 1 2 3 4 5 6 7 8 9 10 Figure 3: Overall architecture of Feature-Augmentation in Decoding (FAiD). fully leveraging the fine-grained visual information in the retrieved patches. We thus further propose FAiD, a feature-based autoregressive augmentation strategy to enhance the image generation process. As illustrated in Figure 3, when predicting the next token vij during image generation, we employ the same retrieval process described in Section 3.2 to obtain the top- K most relevant patches and their representations [ˆv1, ˆv2, ..., ˆvK] from our database. To effectively incorporate them into the autoregressive generation process, FAiD consists of two steps: (1) refining retrieved patches to ensure coherence with the surrounding context of vij in the generated image, and (2) adaptively blending the representation of refined patches with the hidden state of the predicted next patch based on learned compatibility scores. To enable progressive refinement of retrieved information as representations evolve through the network, we insert a FAiD module for every L/b decoder layers of the generation model, where L denotes the total number of decoder layers and b is a hyperparameter. Multi-Scale Feature Smoothing The key of effective patch integration lies in ensuring spatial coherence between retrieved patches and the surrounding image context. To achieve this, we propose multi-scale feature smoothing (Algorithm 1 in Appendix A), where multi-scale convolutions are applied to retrieved patches within the generation