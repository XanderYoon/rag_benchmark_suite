run on the entire dataset as a whole, e.g. Recall (for classification-based metrics). Metrics can use any field and metadata in the dataset, not just the input- output pairs. Some of the metrics implemented in the library include: a wrapper for the Hugging Face evaluate library, EM, F1, classification met- rics, BERTScore (Zhang et al., 2019), Semantic Similarity and a wrapper for DeepEval3 (for using 3https://github.com/confident-ai/deepeval answer_processor: _target_: ragfoundry.processing.RegexAnswer capture_pattern: "Answer: (.*)" stopping_pattern: metrics: - _target_: ragfoundry.evaluation.HFEvaluate metric_names: [ "rouge"] - _target_: ragfoundry.evaluation.EM - _target_: ragfoundry.evaluation.F1 - _target_: ragfoundry.evaluation.BERTScore model: "microsoft/deberta-large-mnli" - _target_: ragfoundry.evaluation.Faithfulness - _target_: ragfoundry.evaluation.Relevancy embeddings: "BAAI/bge-small-en-v1.5" results_file: my-evaluation.yaml generated_file: model-prediction.jsonl data_file: my-processed-data.jsonl Listing 4: Example of an evaluation configuration; it contains an answer processor, as well as the list of met- rics, with optional parameters, to run. the RAGAS metrics (Es et al., 2024)). After the evaluation is completed, a results file is written to disk with the local and global metrics results. Furthermore, the evaluation module uses a pro- cessing step called an Answer Processor, which can implement custom logic and serve many pur- poses, including cleaning and aligning outputs; for example, using regex, one can isolate answers, re- move stop words, chain-of-thought reasoning, de- fine a stopping criteria, process citations and attri- butions and any other form of processing needed for a given evaluation. See listing 4 for a configuration example; it con- tains an answer processor that extracts an answer from an output, and a list of metrics to run. 4 Experiments: RAG Tuning To illustrate the usage and usefulness of the RAG F OUNDRY library, we experiment with sev- eral possible RAG improvements to LLMs, and evaluate the results on three knowledge-intensive tasks. 4.1 RAG Augmentation Techniques We explore several techniques for RAG augmenta- tion, and use RAG F OUNDRY to easily implement