the raw text of many combined fragments (before embedding). In contrast, RAGPart benefits from additional robustness due to mean pooling over fragment embeddings, which can dilute the effect of poisoned fragments and prevent the malicious document from being retrieved under the same conditions. For illustration purposes, we assume that large inner product values (e.g., 24, 36) correspond to the document ending up among the top-p retrieved results, while small values (e.g., –48, 0) correspond to cases where it does not. Retrieval-Augmented Generation: RAG improves the accuracy of LLM outputs and reduces hallucinations by retrieving relevant documents from a knowledge database given a query, and generating responses conditioned on these retrieved documents (Lewis et al., 2021, Izacard and Grave, 2021). Particularly in sensitive fields such as law (Mao et al., 2024), RAG systems enable LLMs to generate reliable outputs that reflect up-to-date knowledge. This effectiveness has led to the wide deployment of RAG on both public and e-commerce platforms. Although traditional retrieval frameworks such as TF-IDF (Salton and Buckley, 1988) and BM25 (Robertson and Zaragoza, 2009) have shown promise in retrieving relevant documents using word frequency statistics, recent advances in transformer-based dense retrievers (Izacard and Grave, 2021, Xiong et al., 2020, Wang et al., 2024, Li et al., 2023)—which encode semantic meanings into embedding vectors—have demonstrated superior performance on state-of-the-art retrieval benchmarks (Muennighoff et al., 2023). Attacks: The corpus poisoning attacks against RAGs can be divided into black-box and white-box attacks 3 RAGPart & RAGMask: Retrieval-Stage Defenses Against Corpus Poisoning in Retrieval-Augmented Generation based on the access the attacker has to the retriever model. The goal of the attacker is to either create a retrievable adversarial passage that can cause a harmful generation when added to the context of an LLM or craft poisons whose addition into the adversarial passage can