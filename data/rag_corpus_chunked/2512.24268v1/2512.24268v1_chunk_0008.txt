RAGPart effectively reduces the impact of the poisoned samples, as demonstrated in the Results section. In the context of dense retrieval as the first stage of RAG, and given the properties of document fragments, a document can be broken intoN fragments. Based on how we form combinations of these fragments, we consider two approaches, as seen below: 1. RAGPart: We first embed each of theN fragments using the dense retrieverâ€™s embedding model. Then, we form combinations ofk fragments (e.g., all(N k )subsets of sizek), and average their embeddings to form a combined representation. This approach leverages the inductive bias of dense retrievers, which produce similar embeddings for semantically related text, allowing the averaged embedding to 4 RAGPart & RAGMask: Retrieval-Stage Defenses Against Corpus Poisoning in Retrieval-Augmented Generation Retrieve Document Document Document Document Document 1 Document 2 Document D-1 Document D --- Embedding 1 Embedding 1 Embedding 1 Embedding 1 -- - Query Embedding Query EmbedEmbed Retrieved Documents For each Document Stage 1: Retrieval Stage 2: Sanitation Mask Embed Query Embedding Masked Embedding Original Embedding Similarity V2 V1 If V2 + ð›¿ > V1 Remove Masked Tokens Stage 3: Reranking Document Document Document Document Query Embedding Sanitized Documents Re-rank based on similarity Top P Document Document Figure 3: RAGMask: Figure illustrates the concept of RAGMask, where the topÎ±p retrieved documents are sanitized by observing the shift in similarity with the query under masking. preserve the original documentâ€™s meaning even when some fragments may be poisoned. This method is illustrated in Figure 1. 2. Naive combination of fragments baseline: In this approach, we first select combinations ofk out ofN document fragments (without first embedding them) and concatenate the raw text. The resulting text is then passed through the embedding model. A toy example containing a comparison between the two methods is shown