HotFlip HotFlip (spread out)Query as PoisonAdvBDGen0 20 40 60 80 100 RAGPart RAGMaskParaphrase % drop in ASR (b) FiQA dataset Figure 8: Drop in attack success rate (ASR)(higher is better): This figure shows that across different datasets and attack types, both of our proposed methods—RAGPart and RAGMask —consistently maintain robustness. While paraphrasing-based defenses perform well against gradient-based attacks, they fail to defend against interpretable attacks such as Query-as-Poison and AdvRAGgen. 10 RAGPart & RAGMask: Retrieval-Stage Defenses Against Corpus Poisoning in Retrieval-Augmented Generation Computational efficiency of RAGPart & RAGMask: Although RAGMask performs better in preserving the utilityofbenignretrievalsandprovidescomparablerobustness, itisrelativelymoreexpensivecomputationally. For a corpus of sizeD and an embedding space of dimensionne, RAGPart requires2ne ⋅D⋅( N k )floating point operations (FLOPs), whereN is the number of fragments andk is the combination size. Given that the retriever requiresR FLOPs to embed a document during the forward pass, RAGMask requiresR⋅ li m ⋅αp FLOPs, whereli is the maximum document length,m is the mask size, andαp is the number of documents retrieved prior to sanitation. In practice,R may be large depending on the retriever’s architecture. Thus, a computational tradeoff exists between RAGPart and RAGMask. However, since retrievers are generally smaller than autoregressive LLMs used for generation, RAGMask remains computationally tractable compared to generation-stage defenses such as Xiang et al. (2024), which require multiple LLM calls at inference time. 6. Theoretical Analysis In the absence of adversarial documents, we assume that the top-p retrieved results across the(N k )possible fragment mixes are consistent up to permutation. Letna denote the number of adversarial documents in the corpus, each containingnp poisoned fragments. We assumena ≤D−p , ensuring that at leastp clean documents remain retrievable. We begin by analyzing the case wherena =1 (the extension tona >1 is discussed later). For each document, there are(N k )combinations of fragments that are