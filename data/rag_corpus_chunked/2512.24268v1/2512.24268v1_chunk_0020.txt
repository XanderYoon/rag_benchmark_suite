)possible fragment mixes are consistent up to permutation. Letna denote the number of adversarial documents in the corpus, each containingnp poisoned fragments. We assumena ≤D−p , ensuring that at leastp clean documents remain retrievable. We begin by analyzing the case wherena =1 (the extension tona >1 is discussed later). For each document, there are(N k )combinations of fragments that are either (1) fed into the embedding model after mixing (in the naive baseline), or (2) pre-embedded individually and averaged later (in RAGPart). When computing top-p results (e.g., as shown in Figure 1), we construct a matrix of sizep×( N k ), where each entry corresponds to a final embedding. In the absence of adversaries, each column would represent a mix of fragments from the same clean document (up to permutation). However, in the presence of a single adversarial document, in the worst-case scenario, instead of observing (N k )occurrences for each of the top-p clean documents, we may observe(N k )occurrences for p−1 clean documents, (N k )−x occurrences for thep-th clean document, andx occurrences for the poisoned mixes. For majority voting to be effective at filtering out poisoned embeddings, we require: x< 1 2 (N k ). Naive Baseline.In the naive combination-of-fragments baseline, embeddings are computed after fragment mixing. As a result, any mix that includes even a single poisoned fragment is considered adversarial. The number of such poisoned mixes is: x= (N k ) − ( N−n p k ). This expression is derived by subtracting the number of fragment mixes that contain no poisoned fragment from the total number of possible mixes. A sufficient condition for robustness in the naive baseline is: (N k ) − ( N−n p k ) < 1 2 (N k ). 11 RAGPart & RAGMask: Retrieval-Stage Defenses Against Corpus Poisoning in