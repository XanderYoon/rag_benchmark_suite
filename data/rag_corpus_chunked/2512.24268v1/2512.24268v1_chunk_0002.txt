- - - - - - - - - 1. Partition 3. Ablate E1 E1 E1 E1 Query EmbeddingQuery Embed Top P 1 Top P 2 Top P 3 4. Retrieve Top P 5. Aggregate E4 E4 E4 E4 E3 E1 E2 E1 E n E1 E3 E1 E2 E1 E n E1 E3 E1 E2 E1 E n E1 E3 E1 E2 E1 E b E1 -- - Figure 1: RAGPart: Figure illustrates the RAGPart defense, where each document is partitioned into fragments, which are individually embedded. Embeddings from multiple fragment combinations (e.g., subsets of size k) are then averaged to produce candidate document representations. These are used to retrieve multiple top-p document sets, which are aggregated to form the final top-p set for retrieval. gation (Xiang et al., 2024). However, these approaches rely on strong and often impractical assumptions. They assume that each retrieved document—often called agolden document—is independently sufficient to answer the query, that the retriever can consistently return enough such golden documents, and that it is computationally feasible to run a separate LLM generation for each one. In real-world systems where inference time and cost are major concerns, generating multiple responses per query is typically infeasible, making these defenses difficult to use in practice. To overcome these issues, practical defenses must satisfy three conditions:(W1)Effectiveness: achieving low attack success rates without significant utility loss under benign conditions;(W2)Efficiency: remaining computationally lightweight for real-time use; and(W3)Minimal retriever assumptions: not requiring perfect or highly accurate retrieval. To satisfy these properties, we propose addressing corpus poisoning earlier—at the retrieval stage. This is feasible in practice because retrievers are typically smaller models than long-context LLMs, and their similarity computations (e.g., dot products in embedding space) are highly parallelizable. Motivated by deep partition-and-aggregation defenses (DPA) (Levine and Feizi, 2021, Sun et al., 2022)