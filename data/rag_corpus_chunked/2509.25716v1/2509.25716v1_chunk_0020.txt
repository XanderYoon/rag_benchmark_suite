strong generalization capabilities without suffering from catastrophic forgetting. The Qwen 0.6B models neither significantly outperform nor degrade compared to the base model performance, indicating successful specialization for our specific use case while preserving general code understanding abilities. G. Reward Function for Reinforcement Learning Our reinforcement learning stage uses completion-aware supervision that inspects the first decision token produced by the reranker. Multiple samples per prompt provide the variance GRPO needs, while auxiliary diagnostics monitor the log-odds gap between “yes” and “no” generations. G.1. Completion-Based Training Reward The default reward passed toGRPOTraineris does the following: • For every sampled completion, we read the first generated token, case-fold it, and test whether it starts with"yes"or"no", since that is what the Qwen 0.6B reranker outputs. •A correct match against the supervision label yields+1.0; an incorrect answer yields−1.0. G.2. Logit-Based Diagnostics We track the mean log-probability of answering"yes"on positive and negative labels, respectively. These diagnostics run alongside the completion-based reward and should trend upward for positive documents once the policy improves. Figure 13:Log-probability of answering yes on positive labels. H. Analysis of Query Enhancement Techniques Our results show that while generating a description with an LLM can help, it does not always work as well as using the code itself for the search. The main reason is that when the LLM creates a natural language summary of the user’s code, it can sometimes miss important details or keywords. In contrast, the other two methods (Prefix Code Embed (Non-FIM) and Hypothetical Code Generation ) use the actual code for retrieval. This provides the search model with more specific information, which likely explains why they perform better in some situations. I. Qualitative Examples of Retrieval Techniques To illustrate the differences between our retrieval methods, this section provides a concrete example of how each technique processes the same