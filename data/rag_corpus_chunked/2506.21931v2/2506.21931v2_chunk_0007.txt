{ ğ‘– âˆˆ I 0 | ğ‘ NLI (ğ‘–, u) â‰¥ ğœƒ }, where ğ‘ NLI (ğ‘–, u) is the NLI alignment score and ğœƒ is a threshold above which an item is considered accepted. The Context Summary Agent then produces a concise summary, ğ‘†ctx = Î¨ n ğ‘‡ (ğ‘–) ğ‘– âˆˆ I + o , where Î¨(Â·) is an LLM-driven summarization function operating on the textual metadata ğ‘‡ (ğ‘–) of each accepted item. 2.2.4 User Understanding Agent. In parallel, theUser Understand- ing Agent (UUA) synthesizes a high-level summary of the userâ€™s preferences, based on the long-term context ğ¶lt and the current session ğ¶st: ğ‘†user = Î© u, where Î©(Â·) is an LLM-based reasoning function that generates a natural language description of the userâ€™s generic interests and immediate goals. 2.2.5 Item Ranker Agent. Finally, the Item Ranker Agent (IRA) uses outputs ğ‘†user and ğ‘†ctx as context for ranking. Prompt for Ranker agent explicitly instructs the model to: (1) consider the userâ€™s behavior in previous sessions, (2) consider the relevant part of the user history to the current ranking task, (3) examine the can- didate items, and (4) rank the items in descending order of purchase likelihood. For example, given a user summary indicating interest in vegan leather products, checkered bags, and stylish accessories, the ranker may prioritize items like the BUTIED Checkered Tote Shoul- der Handbag over the Dasein Hobo Handbag and Womenâ€™s Large Tote based on alignment with both material and style preferences. Formally, the model returns a permutation over the ğ‘Ÿ candidate items: ğœ‹ = ğ‘“rank (ğ‘†user, ğ‘†ctx, I), ğœ‹ = {ğ‘Ÿ1, ğ‘Ÿ2, . . . , ğ‘Ÿğ‘ } where each ğ‘Ÿ ğ‘— âˆˆ { 1, 2, . . . , ğ‘} denotes the index of item in rank ğ‘— in the final ranked list. As one can see under