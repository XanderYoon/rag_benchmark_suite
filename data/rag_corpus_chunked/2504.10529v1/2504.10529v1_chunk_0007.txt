and all chunks into a shared embedding d-dimensional vector space: q = R(Q), e(j) i = R(C(j) i ) (1) The system computes pairwise similarity scores ϕ(q, e(j) i ) between the query embedding and chunk embeddings, typically implemented as cosine simi- larity. The top-k most relevant chunks are passed to LLM G to generate the final response. 3.2 Knolwedge Representation Decoupling Our HeteRAG framework addresses the represen- tation dilemma by decoupling the representations of knowledge chunks for retrieval and generation. As illustrated in Fig 2, the architecture establishes dual pathways for retrieval-oriented and generation- oriented knowledge chunks, enabling specialized optimization for each stage. After chunking the document corpus {Dj}M j=1 into the global chunk collectionSM j=1{C(j) 1 , ..., C(j) Nj }, we model the re- trieval and generation stages separately. The retrieval side aims to precisely align user queries with relevant documents, necessitating comprehensive information from the retrieval side to sufficiently model and compute semantic sim- ilarity. RAG systems across different tasks and domains typically operate on heterogeneous cor- pora with distinct structural characteristics. For in- stance, corpora may exhibit hierarchical tree struc- tures (e.g., Wikipedia articles with nested sections), linear sequences (e.g., news articles with temporal dependencies), or graph-based organizations (e.g., knowledge bases with entity-relation networks). To effectively leverage such diversity, multi-granular information integration at the retrieval side be- comes crucial – this typically encompasses raw knowledge chunks, multi-granular contextual sig- nals, and global structured metadata, each con- tributing complementary perspectives for robust retrieval. For a knowledge chunk C(j) i in document Dj, We formulate the modeling procedure at the 3 retrieval side as follows: e(j) i = R h ψ(C(j) i ) ⊕ψctx({C(j) ictx}) ⊕ψmeta(M(j) i ) i (2) where M (j) i represents the global metadata of C(j) i in Dj, including but not limited